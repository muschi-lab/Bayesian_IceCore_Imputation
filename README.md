# MCMC-based gap filling in ice core CFA data
This script performs MCMC on Continuous Flow Analysis (CFA) records from ice cores that contain missing data to fill short gaps with simulated measurements that retain the same spectral characteristics as the observations. The code was written around the methane data from the Skytrain ice cores presented in "King, A.C.F., Bauska, T.K., Brook, E.J. et al. Reconciling ice core CO2 and land-use change following New World-Old World contact. Nat Commun 15, 1735 (2024). https://doi.org/10.1038/s41467-024-45894-9" but can be adapted to and implemented for a wide range of ice core and other climate records.

The code deploys a Bayesian model that simulates continuous methane data that can be used to fill in short gaps in CFA records. The simulated data retains the same 1. autoregressive (AR) coefficients as the observed CFA measurements, 2. moving average as the observed CFA measurements, and 3. values as the discrete CFA measurements, where such observations are available.
